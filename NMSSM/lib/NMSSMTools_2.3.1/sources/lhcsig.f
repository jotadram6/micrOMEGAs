	SUBROUTINE LSIG()

*   Subroutine to calculate LHC Significances at 30 fb-1:
*    1) bbh/a -> b b tau tau
*    2) h/a -> gamma gamma
*    3) gg -> h -> ZZ -> 4 leptons
*    4) gg -> h -> WW -> 2 leptons 2 neutrinos
*    5) WW -> h -> tau tau
*    6) WW -> h -> W W
*    7) WW -> h -> gamma gamma

	IMPLICIT NONE

	INTEGER I,J

	DOUBLE PRECISION MH(5),SIG(5,7),SIGH(5,7),DM(7)
	DOUBLE PRECISION SMASS(3),SCOMP(3,3),PMASS(2),PCOMP(2,2),CMASS
	DOUBLE PRECISION BRJJ(5),BRMM(5),BRLL(5),BRSS(5),BRCC(5)
	DOUBLE PRECISION BRBB(5),BRTT(5),BRWW(3),BRZZ(3),BRGG(5)
	DOUBLE PRECISION BRZG(5),BRHHH(4),BRHAA(3,3),BRHCHC(3)
	DOUBLE PRECISION BRHAZ(3,2),BRAHA(3),BRAHZ(2,3),BRHCW(5)
	DOUBLE PRECISION BRHIGGS(5),BRNEU(5,5,5),BRCHA(5,3)
	DOUBLE PRECISION BRHSQ(3,10),BRHSL(3,7),BRASQ(2,6),BRASL(2,3)
	DOUBLE PRECISION BRSUSY(5),WIDTH(5)
	DOUBLE PRECISION CU(5),CD(5),CV(3),CJ(5),CG(5)
	DOUBLE PRECISION BRJJSM,BRMMSM,BRLLSM,BRSSSM,BRCCSM
	DOUBLE PRECISION BRBBSM,BRTTSM,BRWWSM,BRZZSM,BRGGSM,BRZGSM
	DOUBLE PRECISION TAUTAULOW,GAGALOW,ZZ4LLOW,WW2LLOW
	DOUBLE PRECISION WWTTLOW,WWWWLOW,WWGGLOW

	COMMON/BRN/BRJJ,BRMM,BRLL,BRSS,BRCC,BRBB,BRTT,BRWW,BRZZ,
     C		BRGG,BRZG,BRHHH,BRHAA,BRHCHC,BRHAZ,BRAHA,BRAHZ,
     C		BRHCW,BRHIGGS,BRNEU,BRCHA,BRHSQ,BRHSL,BRASQ,BRASL,
     C		BRSUSY,WIDTH
	COMMON/REDCOUP/CU,CD,CV,CJ,CG
	COMMON/HIGGSPEC/SMASS,SCOMP,PMASS,PCOMP,CMASS
	COMMON/LOWSIG/SIG

*   Loop over h1, h2, h3
 
	DO I=1,3

	 CALL HDECAY(SMASS(I),BRJJSM,BRMMSM,BRLLSM,BRSSSM,BRCCSM,
     C	             BRBBSM,BRTTSM,BRWWSM,BRZZSM,BRGGSM,BRZGSM)

*   Process 1), bbh -> bbtautau

	 SIG(I,1)=TAUTAULOW(SMASS(I))*CD(I)**2*BRLL(I)/1.D-1

*   Process 2), gg -> h -> gamma gamma

	 SIG(I,2)=GAGALOW(SMASS(I))*CJ(I)**2*BRGG(I)/BRGGSM

*   Process 3), gg -> h -> ZZ -> 4 leptons

	 IF(BRZZSM.NE.0.D0)THEN
	  SIG(I,3)=ZZ4LLOW(SMASS(I))*CJ(I)**2*BRZZ(I)/BRZZSM
	 ELSE
	  SIG(I,3)=0.D0
	 ENDIF

*   Process 4), gg -> h -> WW -> 2 leptons + nu + nu

	 IF(BRWWSM.NE.0.D0)THEN
	  SIG(I,4)=WW2LLOW(SMASS(I))*CJ(I)**2*BRWW(I)/BRWWSM
	 ELSE
	  SIG(I,4)=0.D0
	 ENDIF

*   Process 5), WW -> h -> tautau

	 IF(BRLLSM.NE.0.D0)THEN
	  SIG(I,5)=WWTTLOW(SMASS(I))*CV(I)**2*BRLL(I)/BRLLSM
	 ELSE
	  SIG(I,5)=0.D0
	 ENDIF

*   Process 6), WW -> h -> WW

	 IF(BRWWSM.NE.0.D0)THEN
	  SIG(I,6)=WWWWLOW(SMASS(I))*CV(I)**2*BRWW(I)/BRWWSM
	 ELSE
	  SIG(I,6)=0.D0
	 ENDIF

*   Process 7), WW -> h -> gamma gamma

	 SIG(I,7)=WWGGLOW(SMASS(I))*CV(I)**2*BRGG(I)/BRGGSM

	ENDDO 

*   Loop over a1, a2
 
	DO I=1,2

	 CALL ADECAY(PMASS(I),BRJJSM,BRMMSM,BRLLSM,BRSSSM,BRCCSM,
     C	             BRBBSM,BRTTSM,BRGGSM,BRZGSM)

*   Process 1), bba -> bbtautau

	 SIG(I+3,1)=TAUTAULOW(PMASS(I))*CD(I+3)**2*BRLL(I+3)/1.D-1

*   Process 2), a -> gamma gamma

	 SIG(I+3,2)=GAGALOW(PMASS(I))*CJ(I+3)**2*BRGG(I+3)/BRGGSM

*   Processes 5-7) = 0 (No aVV couplings)

	 DO J=3,7
	  SIG(I+3,J)=0.D0
	 ENDDO

	ENDDO

*   Modify SIG(IJ,K) if |M(I)-M(J)| < DM(K)*(M(I)+M(J))/2 :

	DM(1)=15.D-2
	DM(2)=1.D-2
	DM(3)=1.D-2
	DM(4)=1.D-2
	DM(5)=10.D-2
	DM(6)=10.D-2
	DM(7)=10.D-2

	CALL CLASSIFY(SMASS,PMASS,MH,SIG,SIGH,7)
	CALL COMB(MH,DM,SIGH,7)
	CALL DECLASSIFY(SMASS,PMASS,MH,SIG,SIGH,7)

	END


	SUBROUTINE HSIG()

*   Subroutine to calculate LHC Significances at 300 fb-1:
*    1) h/a -> gamma gamma
*    2) h/a -> gamma gamma lepton
*    3) tth/a -> bb + X
*    4) bbh/a -> bbtautau
*    5) gg -> h -> ZZ -> 4 leptons
*    6) gg -> h -> WW -> 2 leptons 2 neutrinos
*    7) WW -> h -> tautau
*    8) WW -> h -> WW
*    9) WW -> h -> invisible

	IMPLICIT NONE

	INTEGER I,J

	DOUBLE PRECISION MH(5),SIG(5,9),SIGH(5,9),DM(9),LUM
	DOUBLE PRECISION SMASS(3),SCOMP(3,3),PMASS(2),PCOMP(2,2),CMASS
	DOUBLE PRECISION BRJJ(5),BRMM(5),BRLL(5),BRSS(5),BRCC(5)
	DOUBLE PRECISION BRBB(5),BRTT(5),BRWW(3),BRZZ(3),BRGG(5)
	DOUBLE PRECISION BRZG(5),BRHHH(4),BRHAA(3,3),BRHCHC(3)
	DOUBLE PRECISION BRHAZ(3,2),BRAHA(3),BRAHZ(2,3),BRHCW(5)
	DOUBLE PRECISION BRHIGGS(5),BRNEU(5,5,5),BRCHA(5,3)
	DOUBLE PRECISION BRHSQ(3,10),BRHSL(3,7),BRASQ(2,6),BRASL(2,3)
	DOUBLE PRECISION BRSUSY(5),WIDTH(5),BRINV
	DOUBLE PRECISION CU(5),CD(5),CV(3),CJ(5),CG(5)
	DOUBLE PRECISION BRJJSM,BRMMSM,BRLLSM,BRSSSM,BRCCSM
	DOUBLE PRECISION BRBBSM,BRTTSM,BRWWSM,BRZZSM,BRGGSM,BRZGSM
	DOUBLE PRECISION GAGAHIG,GAGALHIG,TTBBHIG
	DOUBLE PRECISION TAUTAUHIG,ZZ4LHIG,WW2LHIG
	DOUBLE PRECISION WWTTHIG,WWWWHIG,WWINVHIG

	COMMON/BRN/BRJJ,BRMM,BRLL,BRSS,BRCC,BRBB,BRTT,BRWW,BRZZ,
     C		BRGG,BRZG,BRHHH,BRHAA,BRHCHC,BRHAZ,BRAHA,BRAHZ,
     C		BRHCW,BRHIGGS,BRNEU,BRCHA,BRHSQ,BRHSL,BRASQ,BRASL,
     C		BRSUSY,WIDTH
	COMMON/REDCOUP/CU,CD,CV,CJ,CG
	COMMON/HIGGSPEC/SMASS,SCOMP,PMASS,PCOMP,CMASS
	COMMON/HIGSIG/SIG

*   Luminosity

	LUM=300.D0

*   Loop over h1, h2, h3
 
	DO I=1,3

	 CALL HDECAY(SMASS(I),BRJJSM,BRMMSM,BRLLSM,BRSSSM,BRCCSM,
     C	             BRBBSM,BRTTSM,BRWWSM,BRZZSM,BRGGSM,BRZGSM)

*   Process 1), gg -> h -> gamma gamma

	 SIG(I,1)=GAGAHIG(SMASS(I))*CJ(I)**2*BRGG(I)/BRGGSM

*   Process 2), Wh + tth -> gamma gamma lepton

	 SIG(I,2)=GAGALHIG(SMASS(I))*(CV(I)**2+CU(I)**2)/2.D0
     C	  *BRGG(I)/BRGGSM

*   Process 3), tth -> bb + X

	 SIG(I,3)=TTBBHIG(SMASS(I))*CU(I)**2*BRBB(I)

*   Process 4), bbh -> bbtautau

	 SIG(I,4)=TAUTAUHIG(SMASS(I))*CD(I)**2*BRLL(I)/9.D-2

*   Process 5), gg -> h -> ZZ -> 4 leptons

	 IF(BRZZSM.NE.0.D0)THEN
	  SIG(I,5)=ZZ4LHIG(SMASS(I))*CJ(I)**2*BRZZ(I)/BRZZSM
	 ELSE
	  SIG(I,5)=0.D0
	 ENDIF

*   Process 6), gg -> h -> WW -> 2 leptons + nu + nu

	 IF(BRWWSM.NE.0.D0)THEN
	  SIG(I,6)=WW2LHIG(SMASS(I))*CJ(I)**2*BRWW(I)/BRWWSM
	 ELSE
	  SIG(I,6)=0.D0
	 ENDIF

*   Process 7), WW -> h -> tautau

	 IF(BRLLSM.NE.0.D0)THEN
	  SIG(I,7)=WWTTHIG(SMASS(I))*CV(I)**2*BRLL(I)/BRLLSM
	 ELSE
	  SIG(I,7)=0.D0
	 ENDIF

*   Process 8), WW -> h -> WW

	 IF(BRWWSM.NE.0.D0)THEN
	  SIG(I,8)=WWWWHIG(SMASS(I))*CV(I)**2*BRWW(I)/BRWWSM
	 ELSE
	  SIG(I,8)=0.D0
	 ENDIF

*   Process 9), WW -> h -> invisible

	 BRINV=BRNEU(I,1,1)
     C	  +BRHAA(I,1)*BRNEU(4,1,1)**2
     C	  +BRHAA(I,2)*BRNEU(4,1,1)*BRNEU(5,1,1)
     C	  +BRHAA(I,3)*BRNEU(5,1,1)**2
	 IF(I.EQ.2)
     C	  BRINV=BRINV+BRHHH(1)*BRNEU(1,1,1)**2
	 IF(I.EQ.3)
     C	  BRINV=BRINV+BRHHH(2)*BRNEU(1,1,1)**2
     C	   +BRHHH(3)*BRNEU(1,1,1)*BRNEU(2,1,1)
     C	   +BRHHH(4)*BRNEU(2,1,1)**2
	 SIG(I,9)=WWINVHIG(SMASS(I))*CV(I)**2*BRINV

	ENDDO 

*   Loop over a1, a2
 
	DO I=1,2

	 CALL ADECAY(PMASS(I),BRJJSM,BRMMSM,BRLLSM,BRSSSM,BRCCSM,
     C	             BRBBSM,BRTTSM,BRGGSM,BRZGSM)

*   Process 1), gg -> a -> gamma gamma

	 SIG(I+3,1)=GAGAHIG(PMASS(I))*CJ(I+3)**2*BRGG(I+3)/BRGGSM

*   Process 2), tta -> gamma gamma lepton

	 SIG(I+3,2)=GAGALHIG(PMASS(I))*CU(I+3)**2/2.D0*BRGG(I+3)/BRGGSM

*   Process 3), tta -> bb + X

	 SIG(I+3,3)=TTBBHIG(PMASS(I))*CU(I+3)**2*BRBB(I+3)

*   Process 4), bba -> bbtautau

	 SIG(I+3,4)=TAUTAUHIG(PMASS(I))*CD(I+3)**2*BRLL(I+3)/9.D-2

*   Processes 5-9) = 0 (No aVV couplings)

	 DO J=5,9
	  SIG(I+3,J)=0.D0
	 ENDDO

	ENDDO

*   Modify SIG(IJ,K) if |M(I)-M(J)| < DM(K)*(M(I)+M(J))/2 :

	DM(1)=1.D-2
	DM(2)=1.D-2
	DM(3)=10.D-2
	DM(4)=15.D-2
	DM(5)=1.D-2
	DM(6)=1.D-2
	DM(7)=10.D-2
	DM(8)=10.D-2
	DM(9)=10.D-2

	CALL CLASSIFY(SMASS,PMASS,MH,SIG,SIGH,9)
	CALL COMB(MH,DM,SIGH,9)
	CALL DECLASSIFY(SMASS,PMASS,MH,SIG,SIGH,9)

*   Rescaling to Luminosity LUM [fb-1]

	DO I=1,5
	 SIG(I,1)=SIG(I,1)*DSQRT(LUM/1.D2)
	 SIG(I,2)=SIG(I,2)*DSQRT(LUM/1.D2)
	 SIG(I,3)=SIG(I,3)*DSQRT(DSQRT(LUM/1.D2))
	 SIG(I,4)=SIG(I,4)*DSQRT(LUM/1.D2)
	 SIG(I,5)=SIG(I,5)*DSQRT(LUM/1.D2)
	 SIG(I,6)=SIG(I,6)*DSQRT(LUM/1.D2)
	 SIG(I,7)=SIG(I,7)*DSQRT(DSQRT(LUM/1.D2))
	 SIG(I,8)=SIG(I,8)*DSQRT(DSQRT(LUM/1.D2))
	 SIG(I,9)=SIG(I,9)
	ENDDO

	END


	DOUBLE PRECISION FUNCTION TAUTAULOW(XMH)

	IMPLICIT NONE

	INTEGER NH,NHM
	PARAMETER (NHM=15)
	DOUBLE PRECISION XMH,MH(NHM),TB(NHM)

	DATA MH/107.D0,110.D0,120.D0,125.D0,130.D0,135.D0,140.D0,200.D0,
     C		240.D0,250.D0,285.D0,295.D0,330.D0,500.D0,800.D0/
	DATA TB/55.D0,50.D0,30.D0,26.D0,26.D0,17.D0,16.7D0,14.D0,
     C		17.D0,18.D0,21.D0,22.D0,26.D0,34.D0,49.D0/

	TAUTAULOW=0.D0

	IF(XMH.LT.MH(1) .OR. XMH.GT.MH(NHM)) RETURN

	DO 1 NH=1,NHM
	 IF(MH(NH).LE.XMH) GOTO 1
	 TAUTAULOW=2.5D0/TB(NH)**2+(MH(NH)-XMH)/(MH(NH)-MH(NH-1))
     C	           *2.5D0*(1.D0/TB(NH-1)**2-1.D0/TB(NH)**2)
	 GOTO 2
 1	CONTINUE
 2	RETURN

	END


	DOUBLE PRECISION FUNCTION GAGALOW(XMH)

	IMPLICIT NONE

	INTEGER NH,NHM
	PARAMETER (NHM=6)
	DOUBLE PRECISION XMH,XN(NHM),MH(NHM)

	DATA MH/100.D0,110.D0,120.D0,130.D0,140.D0,150.D0/
	DATA XN/2.9D0,3.9D0,4.7D0,5.D0,4.5D0,3.3D0/

	GAGALOW=0.D0

	IF(XMH.LT.MH(1) .OR. XMH.GT.MH(NHM)) RETURN

	DO 1 NH=1,NHM
	 IF(MH(NH).LE.XMH) GOTO 1
	 GAGALOW=XN(NH)+(MH(NH)-XMH)/(MH(NH)-MH(NH-1))
     C	           *(XN(NH-1)-XN(NH))
	 GOTO 2
 1	CONTINUE
 2	RETURN

	END


	DOUBLE PRECISION FUNCTION ZZ4LLOW(XMH)

	IMPLICIT NONE

	INTEGER NH,NHM
	PARAMETER (NHM=19)
	DOUBLE PRECISION XMH,XN(NHM),MH(NHM)

	DATA MH/115.D0,120.D0,130.D0,140.D0,150.D0,160.D0,165.D0,170.D0,
     C	        180.D0,190.D0,200.D0,250.D0,300.D0,350.D0,400.D0,450.D0,
     C	        500.D0,550.D0,600.D0/
	DATA XN/2.7D0,4.D0,9.1D0,13.6D0,15.5D0,9.4D0,4.7D0,4.6D0,
     C	        7.9D0,15.8D0,16.D0,13.3D0,13.8D0,14.D0,13.3D0,11.3D0,
     C	        8.8D0,6.8D0,5.7D0/

	ZZ4LLOW=0.D0

	IF(XMH.LT.MH(1) .OR. XMH.GT.MH(NHM)) RETURN

	DO 1 NH=1,NHM
	 IF(MH(NH).LE.XMH) GOTO 1
	 ZZ4LLOW=XN(NH)+(MH(NH)-XMH)/(MH(NH)-MH(NH-1))
     C	           *(XN(NH-1)-XN(NH))
	 GOTO 2
 1	CONTINUE
 2	RETURN

	END


	DOUBLE PRECISION FUNCTION WW2LLOW(XMH)

	IMPLICIT NONE

	INTEGER NH,NHM
	PARAMETER (NHM=8)
	DOUBLE PRECISION XMH,XN(NHM),MH(NHM)

	DATA MH/140.D0,150.D0,160.D0,165.D0,170.D0,180.D0,190.D0,200.D0/
	DATA XN/2.7D0,7.0D0,10.3D0,11.1D0,8.4D0,7.0D0,3.1D0,1.9D0/

	WW2LLOW=0.D0

	IF(XMH.LT.MH(1) .OR. XMH.GT.MH(NHM)) RETURN

	DO 1 NH=1,NHM
	 IF(MH(NH).LE.XMH) GOTO 1
	 WW2LLOW=XN(NH)+(MH(NH)-XMH)/(MH(NH)-MH(NH-1))
     C	           *(XN(NH-1)-XN(NH))
	 GOTO 2
 1	CONTINUE
 2	RETURN

	END


	DOUBLE PRECISION FUNCTION WWTTLOW(XMH)

	IMPLICIT NONE

	INTEGER NH,NHM
	PARAMETER (NHM=4)
	DOUBLE PRECISION XMH,XN(NHM),MH(NHM)

	DATA MH/115.D0,125.D0,135.D0,145.D0/
	DATA XN/4.D0,3.7D0,3.9D0,2.2D0/

	WWTTLOW=0.D0

	IF(XMH.LT.MH(1) .OR. XMH.GT.MH(NHM)) RETURN

	DO 1 NH=1,NHM
	 IF(MH(NH).LE.XMH) GOTO 1
	 WWTTLOW=XN(NH)+(MH(NH)-XMH)/(MH(NH)-MH(NH-1))
     C	           *(XN(NH-1)-XN(NH))
	 GOTO 2
 1	CONTINUE
 2	RETURN

	END


	DOUBLE PRECISION FUNCTION WWWWLOW(XMH)

	IMPLICIT NONE

	INTEGER NH,NHM
	PARAMETER (NHM=11)
	DOUBLE PRECISION XMH,XN(NHM),MH(NHM)

	DATA MH/130.D0,140.D0,150.D0,160.D0,170.D0,180.D0,190.D0,
     C		200.D0,210.D0,220.D0,250.D0/
	DATA XN/2.2D0,5.3D0,7.3D0,8.1D0,8.1D0,7.3D0,6.3D0,
     C	        5.3D0,4.2D0,3.4D0,2.2D0/

	WWWWLOW=0.D0

	IF(XMH.LT.MH(1) .OR. XMH.GT.MH(NHM)) RETURN

	DO 1 NH=1,NHM
	 IF(MH(NH).LE.XMH) GOTO 1
	 WWWWLOW=XN(NH)+(MH(NH)-XMH)/(MH(NH)-MH(NH-1))
     C	           *(XN(NH-1)-XN(NH))
	 GOTO 2
 1	CONTINUE
 2	RETURN

	END


	DOUBLE PRECISION FUNCTION WWGGLOW(XMH)

	IMPLICIT NONE

	INTEGER NH,NHM
	PARAMETER (NHM=5)
	DOUBLE PRECISION XMH,XN(NHM),MH(NHM)

	DATA MH/115.D0,120.D0,130.D0,140.D0,150.D0/
	DATA XN/2.3D0,2.3D0,2.3D0,1.7D0,1.7D0/

	WWGGLOW=0.D0

	IF(XMH.LT.MH(1) .OR. XMH.GT.MH(NHM)) RETURN

	DO 1 NH=1,NHM
	 IF(MH(NH).LE.XMH) GOTO 1
	 WWGGLOW=XN(NH)+(MH(NH)-XMH)/(MH(NH)-MH(NH-1))
     C	           *(XN(NH-1)-XN(NH))
	 GOTO 2
 1	CONTINUE
 2	RETURN

	END


	DOUBLE PRECISION FUNCTION GAGAHIG(XMH)

	IMPLICIT NONE

	INTEGER NH,NHM
	PARAMETER (NHM=6)
	DOUBLE PRECISION XMH,XN(NHM),MH(NHM)

	DATA MH/100.D0,110.D0,120.D0,130.D0,140.D0,150.D0/
	DATA XN/4.2D0,6.D0,6.8D0,8.2D0,7.D0,5.2D0/

	GAGAHIG=0.D0

	IF(XMH.LT.MH(1) .OR. XMH.GT.MH(NHM)) RETURN

	DO 1 NH=1,NHM
	 IF(MH(NH).LE.XMH) GOTO 1
	 GAGAHIG=XN(NH)+(MH(NH)-XMH)/(MH(NH)-MH(NH-1))
     C	           *(XN(NH-1)-XN(NH))
	 GOTO 2
 1	CONTINUE
 2	RETURN

	END


	DOUBLE PRECISION FUNCTION GAGALHIG(XMH)

	IMPLICIT NONE

	INTEGER NH,NHM
	PARAMETER (NHM=8)
	DOUBLE PRECISION XMH,XN(NHM),MH(NHM)

	DATA MH/80.D0,90.D0,100.D0,110.D0,120.D0,130.D0,140.D0,150.D0/
	DATA XN/9.4D0,10.6D0,10.9D0,14.8D0,15.7D0,13.2D0,10.4D0,8.2D0/

	GAGALHIG=0.D0

	IF(XMH.LT.MH(1) .OR. XMH.GT.MH(NHM)) RETURN

	DO 1 NH=1,NHM
	 IF(MH(NH).LE.XMH) GOTO 1
	 GAGALHIG=XN(NH)+(MH(NH)-XMH)/(MH(NH)-MH(NH-1))
     C	            *(XN(NH-1)-XN(NH))
	 GOTO 2
 1	CONTINUE
 2	RETURN

	END


	DOUBLE PRECISION FUNCTION TTBBHIG(XMH)

	IMPLICIT NONE

	INTEGER NH,NHM
	PARAMETER (NHM=8)
	DOUBLE PRECISION XMH,XN(NHM),MH(NHM)

	DATA MH/80.D0,90.D0,100.D0,110.D0,120.D0,130.D0,140.D0,150.D0/
	DATA XN/17.9D0,15.D0,14.1D0,12.3D0,12.7D0,13.7D0,11.3D0,10.6D0/

	TTBBHIG=0.D0

	IF(XMH.LT.MH(1) .OR. XMH.GT.MH(NHM)) RETURN

	DO 1 NH=1,NHM
	 IF(MH(NH).LE.XMH) GOTO 1
	 TTBBHIG=XN(NH)+(MH(NH)-XMH)/(MH(NH)-MH(NH-1))
     C	            *(XN(NH-1)-XN(NH))*DSQRT(30.D0/100.D0)
	 GOTO 2
 1	CONTINUE
 2	RETURN

	END


	DOUBLE PRECISION FUNCTION TAUTAUHIG(XMH)

	IMPLICIT NONE

	INTEGER NH,NHM
	PARAMETER (NHM=13)
	DOUBLE PRECISION XMH,XN(NHM),MH(NHM)

	DATA MH/100.D0,110.D0,120.D0,130.D0,140.D0,150.D0,200.D0,250.D0,
     C	        300.D0,350.D0,400.D0,450.D0,500.D0/
	DATA XN/3.7D-2,4.2D-2,4.4D-2,4.5D-2,4.7D-2,4.6D-2,3.1D-2,
     C	        2.1D-2,1.3D-2,1.D-2,.8D-2,.7D-2,.6D-2/

	TAUTAUHIG=0.D0

	IF(XMH.LT.MH(1) .OR. XMH.GT.MH(NHM)) RETURN

	DO 1 NH=1,NHM
	 IF(MH(NH).LE.XMH) GOTO 1
	 TAUTAUHIG=XN(NH)+(MH(NH)-XMH)/(MH(NH)-MH(NH-1))
     C	           *(XN(NH-1)-XN(NH))
	 GOTO 2
 1	CONTINUE
 2	RETURN

	END


	DOUBLE PRECISION FUNCTION ZZ4LHIG(XMH)

	IMPLICIT NONE

	INTEGER NH,NHM
	PARAMETER (NHM=19)
	DOUBLE PRECISION XMH,XN(NHM),MH(NHM)

	DATA MH/100.D0,120.D0,130.D0,140.D0,150.D0,160.D0,170.D0,180.D0,
     C	        190.D0,200.D0,250.D0,275.D0,350.D0,400.D0,500.D0,600.D0,
     C	        700.D0,800.D0,1000.D0/
	DATA XN/2.7D0,5.3D0,13.2D0,22.1D0,27.8D0,9.4D0,5.5D0,20.7D0,
     C	        25.1D0,26.1D0,21.6D0,17.6D0,22.7D0,21.6D0,21.5D0,17.1D0,
     C	        13.6D0,11.1D0,9.3D0/

	ZZ4LHIG=0.D0

	IF(XMH.LT.MH(1) .OR. XMH.GT.MH(NHM)) RETURN

	DO 1 NH=1,NHM
	 IF(MH(NH).LE.XMH) GOTO 1
	 ZZ4LHIG=XN(NH)+(MH(NH)-XMH)/(MH(NH)-MH(NH-1))
     C	           *(XN(NH-1)-XN(NH))
	 GOTO 2
 1	CONTINUE
 2	RETURN

	END


	DOUBLE PRECISION FUNCTION WW2LHIG(XMH)

	IMPLICIT NONE

	INTEGER NH,NHM
	PARAMETER (NHM=13)
	DOUBLE PRECISION XMH,XN(NHM),MH(NHM)

	DATA MH/120.D0,130.D0,140.D0,150.D0,160.D0,170.D0,180.D0,190.D0,
     C	        200.D0,250.D0,300.D0,600.D0,800.D0/
	DATA XN/5.1D0,9.8D0,17.8D0,21.9D0,47.D0,34.4D0,24.1D0,19.5D0,
     C	        16.9D0,7.9D0,19.4D0,14.2D0,11.3D0/

	WW2LHIG=0.D0

	IF(XMH.LT.MH(1) .OR. XMH.GT.MH(NHM)) RETURN

	DO 1 NH=1,NHM
	 IF(MH(NH).LE.XMH) GOTO 1
	 WW2LHIG=XN(NH)+(MH(NH)-XMH)/(MH(NH)-MH(NH-1))
     C	           *(XN(NH-1)-XN(NH))
	 GOTO 2
 1	CONTINUE
 2	RETURN

	END


	DOUBLE PRECISION FUNCTION WWTTHIG(XMH)

	IMPLICIT NONE

	INTEGER NH,NHM
	PARAMETER (NHM=5)
	DOUBLE PRECISION XMH,XN(NHM),MH(NHM)

	DATA MH/110.D0,120.D0,130.D0,140.D0,150.D0/
	DATA XN/6.7D0,10.4D0,10.4D0,8.7D0,4.4D0/

	WWTTHIG=0.D0

	IF(XMH.LT.MH(1) .OR. XMH.GT.MH(NHM)) RETURN

	DO 1 NH=1,NHM
	 IF(MH(NH).LE.XMH) GOTO 1
	 WWTTHIG=XN(NH)+(MH(NH)-XMH)/(MH(NH)-MH(NH-1))
     C	           *(XN(NH-1)-XN(NH))
	 GOTO 2
 1	CONTINUE
 2	RETURN

	END


	DOUBLE PRECISION FUNCTION WWWWHIG(XMH)

	IMPLICIT NONE

	INTEGER NH,NHM
	PARAMETER (NHM=11)
	DOUBLE PRECISION XMH,XN(NHM),MH(NHM)

	DATA MH/110.D0,115.D0,120.D0,125.D0,130.D0,140.D0,150.D0,160.D0,
     C	        170.D0,180.D0,190.D0/
	DATA XN/2.5D0,5.6D0,9.7D0,15.7D0,20.5D0,18.6D0,26.5D0,34.8D0,
     C	        34.8D0,27.8D0,21.5D0/

	WWWWHIG=0.D0

	IF(XMH.LT.MH(1) .OR. XMH.GT.MH(NHM)) RETURN

	DO 1 NH=1,NHM
	 IF(MH(NH).LE.XMH) GOTO 1
	 WWWWHIG=XN(NH)+(MH(NH)-XMH)/(MH(NH)-MH(NH-1))
     C	           *(XN(NH-1)-XN(NH))
	 GOTO 2
 1	CONTINUE
 2	RETURN

	END


	DOUBLE PRECISION FUNCTION WWINVHIG(XMH)

	IMPLICIT NONE

	INTEGER NH,NHM
	PARAMETER (NHM=7)
	DOUBLE PRECISION XMH,XN(NHM),MH(NHM)

	DATA MH/100.D0, 150.D0, 200.D0, 250.D0, 300.D0, 350.D0, 400.D0/
	DATA XN/16.D0, 14.D0, 13.D0, 11.D0, 10.D0, 8.D0, 7.D0/

	WWINVHIG=0.D0

	IF(XMH.LT.MH(1) .OR. XMH.GT.MH(NHM)) RETURN

	DO 1 NH=1,NHM
	 IF(MH(NH).LE.XMH) GOTO 1
	 WWINVHIG=XN(NH)+(MH(NH)-XMH)/(MH(NH)-MH(NH-1))
     C	           *(XN(NH-1)-XN(NH))
	 GOTO 2
 1	CONTINUE
 2	RETURN

	END


	SUBROUTINE CLASSIFY(SM,PM,MH,S,SH,N)

	IMPLICIT NONE
	INTEGER N,I,J,K,L
	DOUBLE PRECISION SM(3),PM(2),MH(5),S(5,*),SH(5,*)

	I=1
	J=1
	K=1
 1	IF(I.LE.3 .AND. J.LE.2)THEN
	 IF(SM(I).LE.PM(J))THEN
	  MH(K)=SM(I)
	  DO L=1,N 
	   SH(K,L)=S(I,L)
	  ENDDO
	  I=I+1
	 ELSE
	  MH(K)=PM(J)
	  DO L=1,N 
	   SH(K,L)=S(J+3,L)
	  ENDDO
	  J=J+1
	 ENDIF
	 K=K+1
	 GOTO 1
	ENDIF

 2	IF(I.LE.3)THEN
	 MH(K)=SM(I)
	 DO L=1,N 
	  SH(K,L)=S(I,L)
	 ENDDO
	 I=I+1
	 K=K+1
	 GOTO 2
	ENDIF

 3	IF(J.LE.2)THEN
	 MH(K)=PM(J)
	 DO L=1,N 
	  SH(K,L)=S(J+3,L)
	 ENDDO
	 J=J+1
	 K=K+1
	 GOTO 3
	ENDIF

	END


	SUBROUTINE COMB(MH,DM,SH,N)

	IMPLICIT NONE
	INTEGER N,I,J,K
	DOUBLE PRECISION MH(5),DM(*),SH(5,*),D(4),S

	DO I=1,N

	 DO J=1,4
	  D(J)=(MH(J+1)-MH(J))/DM(I)*2.D0/(MH(J)+MH(J+1))
	 ENDDO


	 IF(D(1).LE.1.D0 .AND. D(2).LE.1.D0 .AND. D(3).LE.1.D0
     C	  .AND. D(4).LE.1.D0)THEN
	  S=0.D0
	  DO K=1,5
	   S=S+SH(K,I)
	  ENDDO
	  DO K=1,5
	   SH(K,I)=S
	  ENDDO
	  GOTO 1
	 ENDIF

	 IF(D(1).LE.1.D0 .AND. D(2).LE.1.D0 .AND. D(3).LE.1.D0)THEN
	  S=0.D0
	  DO K=1,4
	   S=S+SH(K,I)
	  ENDDO
	  DO K=1,4
	   SH(K,I)=S
	  ENDDO
	  GOTO 1
	 ENDIF

	 IF(D(2).LE.1.D0 .AND. D(3).LE.1.D0 .AND. D(4).LE.1.D0)THEN
	  S=0.D0
	  DO K=2,5
	   S=S+SH(K,I)
	  ENDDO
	  DO K=2,5
	   SH(K,I)=S
	  ENDDO
	  GOTO 1
	 ENDIF

	 IF(D(1).LE.1.D0 .AND. D(2).LE.1.D0)THEN
	  S=0.D0
	  DO K=1,3
	   S=S+SH(K,I)
	  ENDDO
	  DO K=1,3
	   SH(K,I)=S
	  ENDDO
	  IF(D(4).LE.1.D0)THEN
	   S=0.D0
	   DO K=4,5
	    S=S+SH(K,I)
	   ENDDO
	   DO K=4,5
	    SH(K,I)=S
	   ENDDO
	  ENDIF
	  GOTO 1
	 ENDIF

	 IF(D(2).LE.1.D0 .AND. D(3).LE.1.D0)THEN
	  S=0.D0
	  DO K=2,4
	   S=S+SH(K,I)
	  ENDDO
	  DO K=2,4
	   SH(K,I)=S
	  ENDDO
	  GOTO 1
	 ENDIF

	 IF(D(3).LE.1.D0 .AND. D(4).LE.1.D0)THEN
	  S=0.D0
	  DO K=3,5
	   S=S+SH(K,I)
	  ENDDO
	  DO K=3,5
	   SH(K,I)=S
	  ENDDO
	  IF(D(1).LE.1.D0)THEN
	   S=0.D0
	   DO K=1,2
	    S=S+SH(K,I)
	   ENDDO
	   DO K=1,2
	    SH(K,I)=S
	   ENDDO
	  ENDIF
	  GOTO 1
	 ENDIF

	 IF(D(1).LE.1.D0)THEN
	  S=0.D0
	  DO K=1,2
	   S=S+SH(K,I)
	  ENDDO
	  DO K=1,2
	   SH(K,I)=S
	  ENDDO
	  IF(D(3).LE.1.D0)THEN
	   S=0.D0
	   DO K=3,4
	    S=S+SH(K,I)
	   ENDDO
	   DO K=3,4
	    SH(K,I)=S
	   ENDDO
	  ENDIF
	  IF(D(4).LE.1.D0)THEN
	   S=0.D0
	   DO K=4,5
	    S=S+SH(K,I)
	   ENDDO
	   DO K=4,5
	    SH(K,I)=S
	   ENDDO
	  ENDIF
	  GOTO 1
	 ENDIF

	 IF(D(2).LE.1.D0)THEN
	  S=0.D0
	  DO K=2,3
	   S=S+SH(K,I)
	  ENDDO
	  DO K=2,3
	   SH(K,I)=S
	  ENDDO
	  IF(D(4).LE.1.D0)THEN
	   S=0.D0
	   DO K=4,5
	    S=S+SH(K,I)
	   ENDDO
	   DO K=4,5
	    SH(K,I)=S
	   ENDDO
	  ENDIF
	  GOTO 1
	 ENDIF

	 IF(D(3).LE.1.D0)THEN
	  S=0.D0
	  DO K=3,4
	   S=S+SH(K,I)
	  ENDDO
	  DO K=3,4
	   SH(K,I)=S
	  ENDDO
	  GOTO 1
	 ENDIF

	 IF(D(4).LE.1.D0)THEN
	  S=0.D0
	  DO K=4,5
	   S=S+SH(K,I)
	  ENDDO
	  DO K=4,5
	   SH(K,I)=S
	  ENDDO
	  GOTO 1
	 ENDIF

 1	CONTINUE
	ENDDO

	END


	SUBROUTINE DECLASSIFY(SM,PM,MH,S,SH,N)

	IMPLICIT NONE
	INTEGER N,I,J,K,L
	DOUBLE PRECISION SM(3),PM(2),MH(5),S(5,*),SH(5,*)

	I=1
	J=1
	K=1
 1	IF(I.LE.3 .AND. J.LE.2)THEN
	 IF(SM(I).EQ.MH(K))THEN
	  DO L=1,N 
	   S(I,L)=SH(K,L)
	  ENDDO
	  I=I+1
	 ELSE
	  DO L=1,N 
	   S(J+3,L)=SH(K,L)
	  ENDDO
	  J=J+1
	 ENDIF
	 K=K+1
	 GOTO 1
	ENDIF

 2	IF(I.LE.3)THEN
	 DO L=1,N 
	  S(I,L)=SH(K,L)
	 ENDDO
	 I=I+1
	 K=K+1
	 GOTO 2
	ENDIF

 3	IF(J.LE.2)THEN
	 DO L=1,N 
	  S(J+3,L)=SH(K,L)
	 ENDDO
	 J=J+1
	 K=K+1
	 GOTO 3
	ENDIF

	END
